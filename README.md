#### ç›®å½• 

```
â”œâ”€ dist                            // ç¼–è¾‘ç»“æœç›®å½•
â”œâ”€ config                          // taroç¼–è¯‘é…ç½®ç›®å½•
â”‚  â”œâ”€ dev.js                       // å¼€å‘ç¯å¢ƒé…ç½®
â”‚  â”œâ”€ index.js                     // é»˜è®¤é…ç½®
â”‚  â””â”€ prod.js                      // ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€ src                             // æºç ç›®å½•
â”‚  â”œâ”€ apis                         // å…¨å±€æ¥å£
â”‚  â”œâ”€ assets                       // éœ€è¦æ‰“åŒ…çš„é™æ€èµ„æº
â”‚  â”‚  â””â”€ iconfont                  // å­—ä½“å›¾æ ‡
â”‚  â”‚  â””â”€ style                     // style/css
â”‚  â”‚  â””â”€ img                       // å›¾ç‰‡
â”‚  â”œâ”€ components                   // å…¨å±€é€šç”¨ç»„ä»¶ 
â”‚  â”œâ”€ constants                    // å…¨å±€å¸¸é‡
â”‚  â”œâ”€ pages                        // é¡µé¢æ–‡ä»¶ç›®å½•
â”‚  â”‚  â””â”€ tab                       // tab-baré¡µé¢æ¨¡å—ï¼Œåé¢å°ç¨‹åºåˆ†åŒ…ä¼šè®²åˆ°
â”‚  â”‚  â”‚  â”œâ”€ apis                   // tab-baré¡µé¢ä¸‹çš„æ¥å£
â”‚  â”‚  â”‚  â”œâ”€ home                   // homeé¡µé¢
â”‚  â”‚  â”‚  â”‚  â”œâ”€ index.config.ts     // é¡µé¢é…ç½®
â”‚  â”‚  â”‚  â”‚  â”œâ”€ index.less          // é¡µé¢æ ·å¼
â”‚  â”‚  â”‚  â””â”€ â””â”€ index.tsx           // é¡µé¢é€»è¾‘
â”‚  â”‚  â”œâ”€ user                      // ä¸ªäººä¸­å¿ƒé¡µé¢æ¨¡å—
â”‚  â”‚  â”‚  â”œâ”€ apis                   // ä¸ªäººä¸­å¿ƒä¸‹çš„æ¥å£
â”‚  â”‚  â”‚  â”œâ”€ settings               // ä¸ªäººä¿¡æ¯è®¾ç½®é¡µ
â”‚  â”‚  â”‚  â””â”€ address                // ä¸ªäººæ”¶è·åœ°å€ä¿¡æ¯é¡µ
â”‚  â”‚  â”œâ”€ order                     // è®¢å•é¡µé¢æ¨¡å—
â”‚  â”‚  â”‚  â”œâ”€ apis                   // è®¢å•ä¸‹çš„æ¥å£
â”‚  â”‚  â”‚  â”œâ”€ list                   // è®¢å•åˆ—è¡¨é¡µ
â”‚  â”‚  â”‚  â””â”€ detail                 // è®¢å•è¯¦æƒ…é¡µ
â”‚  â”œâ”€ types                        // tsç±»å‹æ–‡ä»¶
â”‚  â”œâ”€ utils                        // å·¥å…·æ–‡ä»¶ç›®å½•
â”‚  â”‚  â”œâ”€ cookie.ts                 // cookieæ¨¡å—  
â”‚  â”‚  â”œâ”€ https.ts                  // ç½‘ç»œè¯·æ±‚æ¨¡å—
â”‚  â”‚  â””â”€ index.ts                  // åŸºç¡€æ¨¡å—
â”‚  â”œâ”€ app.config.ts                // taroé¡¹ç›®å…¥å£é…ç½®
â”‚  â”œâ”€ app.less                     // é¡¹ç›®æ€»æ ·å¼
â”‚  â”œâ”€ app.ts                       // é¡¹ç›®å…¥å£æ–‡ä»¶
â”‚  â”œâ”€ index.html                   // 
â”œâ”€ .editorconfig
â”œâ”€ .env                            // å¼€å‘ç¯å¢ƒç¯å¢ƒå˜é‡
â”œâ”€ .env.pre                        // é¢„å‘ç¯å¢ƒç¯å¢ƒå˜é‡
â”œâ”€ .env.prod                       // ç”Ÿäº§ç¯å¢ƒç¯å¢ƒå˜é‡
â”œâ”€ .env.test                       // æµ‹è¯•ç¯å¢ƒç¯å¢ƒå˜é‡
â”œâ”€ .eslintrc.js                    // esLintè§„åˆ™é…ç½®
â”œâ”€ .gitignore                      // gitå¿½ç•¥æ–‡ä»¶    
â”œâ”€ babel.config.js                 // Babelé…ç½®
â”œâ”€ tsconfig.json                   // tsé…ç½®æ–‡ä»¶
â”œâ”€ global.d.ts
â”œâ”€ iconfont.json                   // å›¾ç‰‡å¤„ç†é…ç½®æ–‡ä»¶
â”œâ”€ package.json 
â”œâ”€ project.config.json
â”œâ”€ project.tt.json
â””â”€ tsconfig.json


```

#### CLI å·¥å…·å®‰è£…

```
# ä½¿ç”¨ npm å®‰è£… CLI
$ npm/pnpm install -g @tarojs/cli

# OR ä½¿ç”¨ yarn å®‰è£… CLI
$ yarn global add @tarojs/cli

# OR å®‰è£…äº† cnpmï¼Œä½¿ç”¨ cnpm å®‰è£… CLI
$ cnpm install -g @tarojs/cli
```

#### æŸ¥çœ‹ Taro å…¨éƒ¨ç‰ˆæœ¬ä¿¡æ¯

```
pnpm info @tarojs/cli
```

#### é¡¹ç›®åˆå§‹åŒ–

ä½¿ç”¨å‘½ä»¤åˆ›å»ºæ¨¡æ¿é¡¹ç›®ï¼š

```
$ taro init myApp
```

> npm 5.2+ ä¹Ÿå¯åœ¨ä¸å…¨å±€å®‰è£…çš„æƒ…å†µä¸‹ä½¿ç”¨ npx åˆ›å»ºæ¨¡æ¿é¡¹ç›®ï¼š

```
$ npx @tarojs/cli init myApp
```

> åœ¨åˆ›å»ºå®Œé¡¹ç›®ä¹‹åï¼ŒTaro ä¼šé»˜è®¤å¼€å§‹å®‰è£…é¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå®‰è£…ä½¿ç”¨çš„å·¥å…·æŒ‰ç…§ yarn > cnpm > npm é¡ºåºè¿›è¡Œæ£€æµ‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¾èµ–å®‰è£…ä¼šæ¯”è¾ƒé¡ºåˆ©ï¼Œä½†æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šå®‰è£…å¤±è´¥ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹è‡ªå·±ä½¿ç”¨å®‰è£…å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š

```
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
$ cd myApp

# ä½¿ç”¨ yarn å®‰è£…ä¾èµ–
$ yarn

# OR ä½¿ç”¨ npm å®‰è£…ä¾èµ–
$ npm install

# OR ä½¿ç”¨ pnpm å®‰è£…ä¾èµ–
$ pnpm install

# OR ä½¿ç”¨ cnpm å®‰è£…ä¾èµ–
$ cnpm install
```

#### è®¾ç½®ä»£ç è§„èŒƒçš„ Eslint Prettier CommitLint

- ä»£ç è§„èŒƒ ESlint
- ä»£ç æ ¼å¼åŒ– Prettier
- æäº¤è§„èŒƒ CommitLint

  1.å®‰è£… eslint prettier stylelint ç›¸å…³æ’ä»¶

```
pnpm add prettier li
nt-staged -D
```

> .eslintrc é…ç½®

```
{
  "extends": ["taro/react"],
  "rules": {
    "react/jsx-uses-react": 2,
    "react/react-in-jsx-scope": "off",
    // allow async-await
    "generator-star-spacing": "off",
    // allow debugger during development
    "no-console": "off",
    "no-debugger": "off",
    // å¼ºåˆ¶åœ¨ functionçš„å·¦æ‹¬å·ä¹‹å‰ä½¿ç”¨ä¸€è‡´çš„ç©ºæ ¼
    "space-before-function-paren": 0,
    // å¼•å·ç±»å‹
    // ç¦æ­¢å‡ºç°æœªä½¿ç”¨è¿‡çš„å˜é‡
    "no-unused-vars": 0,
    // ä¸¥æ ¼çš„æ£€æŸ¥ç¼©è¿›é—®é¢˜
    "indent": 0,
    //å¼•å…¥æ¨¡å—æ²¡æœ‰æ”¾å…¥é¡¶éƒ¨
    "import/first": 0,
    //åé¢æ²¡æœ‰ç©ºä½ï¼ŒThere should be no space after this paren
    "space-in-parens": 0,
    //å·²å®šä¹‰ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨ï¼Œ"scope" is defined but never used
    "vue/no-unused-vars": 0,
    "@typescript-eslint/no-non-null-assertion": "off", // å…è®¸ä½¿ç”¨éç©ºæ“ä½œç¬¦
    /**
     * æœ€ä½³å®è·µ
     */
    "eqeqeq": 2, // å¼ºåˆ¶ä½¿ç”¨ === å’Œ !==
    "default-case": 1, // è¦æ±‚ switch è¯­å¥ä¸­æœ‰ default åˆ†æ”¯
    "no-else-return": 1, // ç¦æ­¢ if è¯­å¥ä¸­ return è¯­å¥ä¹‹åæœ‰ else å—
    "no-empty-function": 0, // ç¦æ­¢å‡ºç°ç©ºå‡½æ•°
    "no-multi-spaces": 1, // ç¦æ­¢ä½¿ç”¨å¤šä¸ªç©ºæ ¼
    "radix": 1, // å¼ºåˆ¶åœ¨parseInt()ä½¿ç”¨åŸºæ•°å‚æ•°
    "@typescript-eslint/no-unused-vars": ["error"], // æŠŠè¯¥æ¡æç¤ºä¿¡æ¯è½¬æ¢æˆè­¦å‘Šä¿¡æ¯
    /**
     * å˜é‡å£°æ˜
     */
    "init-declarations": ["error", "always"], // å£°æ˜å˜é‡å¿…é¡»èµ‹å€¼
    // "array-bracket-spacing": ["error", "always"], // æ•°ç»„æ–¹æ‹¬å·å†…å¿…é¡»ç©ºæ ¼
    "array-bracket-spacing": 0, // æ•°ç»„æ–¹æ‹¬å·å†…å¿…é¡»ç©ºæ ¼
    // åŒå³°é©¼å‘½åæ ¼å¼
    "camelcase": 2,
    // æ•°ç»„å’Œå¯¹è±¡é”®å€¼å¯¹æœ€åä¸€ä¸ªé€—å·ï¼Œ neverå‚æ•°ï¼šä¸èƒ½å¸¦æœ«å°¾çš„é€—å·, alwayså‚æ•°ï¼šå¿…é¡»å¸¦æœ«å°¾çš„é€—å·ï¼Œ
    // always-multilineï¼šå¤šè¡Œæ¨¡å¼å¿…é¡»å¸¦é€—å·ï¼Œå•è¡Œæ¨¡å¼ä¸èƒ½å¸¦é€—å·
    "comma-dangle": [2, "never"],
    // æ§åˆ¶é€—å·å‰åçš„ç©ºæ ¼
    "comma-spacing": [2, { "before": false, "after": true }],
    "comma-style": [2, "last"], // é€—å·é£æ ¼ï¼Œæ¢è¡Œæ—¶åœ¨è¡Œé¦–è¿˜æ˜¯è¡Œå°¾
    "eol-last": 2, // è¦æ±‚æ–‡ä»¶æœ«å°¾å­˜åœ¨ç©ºè¡Œ
    // å¯¹è±¡å†’å·å‰ç¦æ­¢ç©ºæ ¼ï¼Œå†’å·åå¿…é¡»ç©ºæ ¼
    "key-spacing": ["error", { "beforeColon": false, "afterColon": true }],
    // å…³é”®å­—ï¼ˆifã€elseç­‰ï¼‰å‰åå¿…é¡»æœ‰ç©ºæ ¼
    "keyword-spacing": ["error", { "before": true, "after": true }],
    // ç¦æ­¢å‡ºç°å¤šè¡Œç©ºè¡Œ
    "no-multiple-empty-lines": ["error", { "max": 1 }],
    "semi": ["error", "never"], // ç¦æ­¢æœ«å°¾åˆ†å·
    "quotes": ["error", "single"], // å•å¼•å·
    "space-infix-ops": 2, // æ“ä½œç¬¦å‘¨å›´å¿…é¡»æœ‰ç©ºæ ¼
    "spaced-comment": ["error", "always"], // æ³¨é‡Šåé¢å¿…é¡»è·Ÿéšè‡³å°‘ä¸€ä¸ªç©ºç™½
    /**
     * ECMAScript6
     */
    "arrow-spacing": ["error", { "before": true, "after": true }], // å¼ºåˆ¶ç®­å¤´å‡½æ•°çš„ç®­å¤´å‰åä½¿ç”¨ç©ºæ ¼
    "no-var": 2, // ç¦æ­¢ä½¿ç”¨ var å£°æ˜å˜é‡
    "object-shorthand": 2, // è¦æ±‚ä½¿ç”¨å¯¹è±¡æ–¹æ³•åå’Œå±æ€§åç®€å†™
    "prefer-arrow-callback": 2, // è¦æ±‚å›è°ƒå‡½æ•°ä½¿ç”¨ç®­å¤´å‡½æ•°
    "prefer-const": 2, // ä½¿ç”¨ const å£°æ˜é‚£äº›å£°æ˜åä¸å†è¢«ä¿®æ”¹çš„å˜é‡
    "prefer-rest-params": 2, // è¦æ±‚ä½¿ç”¨å‰©ä½™å‚æ•°è€Œä¸æ˜¯ arguments
    /**
     * vue
     */
    "vue/valid-v-model": 0
  },
  "settings": {
    // è®©eslintè‡ªå·±æ£€æµ‹reactç‰ˆæœ¬
    "react": {
      "version": "detect"
    }
  }
}


```

ç”¨ TypeScript çš„é¡¹ç›®ï¼Œå¦‚è‹¥é…ç½®å®Œ ESLintï¼Œå¯¹äºä¸è§„èŒƒçš„ä»£ç ç¼–è¯‘å™¨æ²¡æœ‰æ­£å¸¸ç»™å‡ºæç¤ºã€‚æœ‰å¯èƒ½æ˜¯ ESLint è·³è¿‡äº†å¯¹ ts æ–‡ä»¶çš„æ£€æŸ¥ï¼Œå¯ä»¥å¯¹å…¨å±€ settings.json æ–‡ä»¶åŠ ä¸Šå¦‚ä¸‹é…ç½®ï¼š

```
"eslint.validate": [
  "javascript",
  "javascriptreact",
  "html",
  "typescriptreact"
]
```

æ­¤æ—¶ï¼Œå°è¯•ç¼–å†™ä¸€äº›ä¸è§„èŒƒçš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç¼–è¯‘å™¨æ˜¯ä¼šæ­£å¸¸ç»™å‡ºæç¤ºä¿¡æ¯çš„ï¼š

å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ package.json æ–‡ä»¶ä¸­çš„ scripts é…ç½®é¡¹æ–°å¢ä¸€æ¡ lint å‘½ä»¤ï¼Œç”¨å‘½ä»¤æ¥æ£€æŸ¥æ‰€æœ‰ä¸è§„èŒƒçš„ä»£ç ï¼š

```
"lint": "eslint --ext .tsx,.ts,.js,.jsx src --fix",
```

å†åœ¨ç»ˆç«¯è¿è¡Œ npm run lint å‘½ä»¤ï¼Œç»ˆç«¯ä¸­ä¹Ÿä¼šç»™å‡ºç›¸åº”çš„æŠ¥é”™ä¿¡æ¯ï¼Œä»¥åŠæŠ¥é”™ä¿¡æ¯æ‰€åœ¨çš„æ–‡ä»¶

å¦‚æœéœ€è¦ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤ ESLint é”™è¯¯

vscode é¦–å…ˆéœ€è¦ä¸‹è½½ ESLint æ’ä»¶ã€‚

ä¸‹è½½å®Œæˆä¹‹åï¼Œå†åœ¨å…¨å±€çš„ settings.json æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®ï¼š

```
"editor.codeActionsOnSave": {
  "source.fixAll.eslint": true
}
```

> .prettierrc é…ç½®

```
// å…·ä½“é…ç½®å¯ä»¥å‚è€ƒ https://prettier.io/docs/en/options.html
module.exports = {
  printWidth: 100, // ä¸€è¡Œçš„å­—ç¬¦æ•°ï¼Œå¦‚æœè¶…è¿‡ä¼šè¿›è¡Œæ¢è¡Œ
  tabWidth: 2, // ä¸€ä¸ªtabä»£è¡¨å‡ ä¸ªç©ºæ ¼æ•°ï¼Œé»˜è®¤å°±æ˜¯2
  useTabs: false, // æ˜¯å¦å¯ç”¨tabå–ä»£ç©ºæ ¼ç¬¦ç¼©è¿›ï¼Œ.editorconfigè®¾ç½®ç©ºæ ¼ç¼©è¿›ï¼Œæ‰€ä»¥è®¾ç½®ä¸ºfalse
  semi: false, // è¡Œå°¾æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue
  singleQuote: true, // å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·
  trailingComma: 'none', // å¯¹è±¡æˆ–æ•°ç»„æœ«å°¾æ˜¯å¦æ·»åŠ é€—å· none| es5| all
  jsxSingleQuote: true, // åœ¨jsxé‡Œæ˜¯å¦ä½¿ç”¨å•å¼•å·ï¼Œä½ çœ‹ç€åŠ
  bracketSpacing: true, // å¯¹è±¡å¤§æ‹¬å·ç›´æ¥æ˜¯å¦æœ‰ç©ºæ ¼ï¼Œé»˜è®¤ä¸ºtrueï¼Œæ•ˆæœï¼š{ foo: bar }
  arrowParens: "avoid", // ç®­å¤´å‡½æ•°å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°åˆ™çœç•¥æ‹¬å·
  // jsx æ ‡ç­¾çš„åå°–æ‹¬å·éœ€è¦æ¢è¡Œ
  jsxBracketSameLine: true,
  quoteProps: 'as-needed',
  htmlWhitespaceSensitivity: 'ignore', // strict, ignore
  vueIndentScriptAndStyle: true,
  endOfLine: 'lf',
  rangeStart: 0,
  proseWrap: 'never',
};

```

2.åœ¨ package.json ä¸­ script æ·»åŠ å‘½ä»¤

```
"lint": "eslint --ext .tsx,.ts,.js,.jsx src --fix"
```

3.æ·»åŠ  husky è§¦å‘ Git é’©å­æ¥ä¿è¯ä»£ç æäº¤æ—¶ Ts æ£€æŸ¥å’Œ Eslint æ£€æŸ¥éƒ½ç¬¦åˆè§„èŒƒ

- Git Hooks æäº¤æ—¶è‡ªåŠ¨æ ¡éªŒ husky å±äº git hooks å·¥å…·ï¼Œå¯é…ç½®è®©å…¶åœ¨ git çš„ä¸åŒç”Ÿå‘½å‘¨æœŸï¼Œæ‰§è¡Œä¸åŒçš„å‘½ä»¤ï¼Œæ¥çº¦æŸæˆ‘ä»¬çš„å¼€å‘ã€‚

```
# https://github.com/typicode/husky
# https://typicode.github.io/husky/#/?id=articles
yarn add husky -D
# åˆå§‹åŒ– husky
npx husky install

å®‰è£…å®Œæˆä¹‹åé¡¹ç›®æ ¹ç›®å½•ä¸‹é¢ä¼šå¤šå‡ºä¸€ä¸ª .husky æ–‡ä»¶ï¼Œç”¨æ¥å­˜æ”¾åç»­æˆ‘ä»¬æ·»åŠ çš„ git hooksã€‚

å¦‚æœæƒ³è®©åˆ«äººå®‰è£…æˆ‘ä»¬çš„é¡¹ç›®ä¾èµ–åï¼Œè‡ªåŠ¨å¯ç”¨ git hooksï¼Œå¯ä»¥åœ¨ package.json æ·»åŠ  prepare å‘½ä»¤ï¼š
```

"prepare": "husky install"

```

prepare æ˜¯ npm æ“ä½œç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€ç¯ï¼Œåœ¨æ‰§è¡Œ install çš„æ—¶å€™ä¼šæŒ‰ç”Ÿå‘½å‘¨æœŸé¡ºåºæ‰§è¡Œç›¸åº”é’©å­ã€‚

```

npm7 ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š preinstall -> install -> postinstall -> prepublish -> preprepare -> prepare -> postprepareã€‚

```

# å†™å…¥å‘½ä»¤
# æ·»åŠ  pre-commit é’©å­ã€‚
npx husky add .husky/pre-commit "npx lint-staged"

```

è¿™é‡Œçš„ npx lint-staged ä¸ºæ ¡éªŒæ–‡ä»¶çš„å‘½ä»¤ï¼Œä¼šåœ¨æäº¤ä»£ç ä¹‹å‰è‡ªåŠ¨æ‰§è¡Œï¼Œå¯è‡ªè¡Œä¿®æ”¹å‘½ä»¤

package.json æ·»åŠ å¦‚ä¸‹ï¼š

```

  "lint-staged": {
    "*.{vue, js, ts, jsx, tsx}": "eslint --fix",
    "*.{css, less}": "stylelint --fix"
  },
```

4. é…ç½® commitlint æé«˜æäº¤æ—¶çš„è§„èŒƒ

```
pnpm add  @commitlint/cli @commitlint/config-conventional commitizen cz-customizable -D

# commitlint.config.js
```

```
module.exports = {
  // ç»§æ‰¿çš„è§„åˆ™
  extends: ['@commitlint/config-conventional'],
  // å®šä¹‰è§„åˆ™ç±»å‹
  rules: {
    // type ç±»å‹å®šä¹‰ï¼Œè¡¨ç¤º git æäº¤çš„ type å¿…é¡»åœ¨ä»¥ä¸‹ç±»å‹èŒƒå›´å†…
    'type-enum': [
      2,
      'always',
      [
        'feat', // æ–°åŠŸèƒ½ feature
        'fix', // ä¿®å¤ bug
        'docs', // æ–‡æ¡£æ³¨é‡Š
        'style', // ä»£ç æ ¼å¼(ä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨)
        'refactor', // é‡æ„(æ—¢ä¸å¢åŠ æ–°åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®å¤bug)
        'perf', // æ€§èƒ½ä¼˜åŒ–
        'test', // å¢åŠ æµ‹è¯•
        'chore', // æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
        'revert', // å›é€€
        'build', // æ‰“åŒ…
      ],
    ],
    // subject å¤§å°å†™ä¸åšæ ¡éªŒ
    'subject-case': [0],
  },
}

# æ·»åŠ  commit-msg é’©å­ã€‚

commit-msg é’©å­ç”¨æ¥è§„èŒƒæäº¤ä»£ç æ—¶çš„æäº¤ä¿¡æ¯
```

npx husky add .husky/commit-msg "npx --no -- commitlint --edit '$1'"

npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'

```

# é¦–æ¬¡å®‰è£…ä¸èµ·ä½œç”¨å¯ä»¥è¿è¡Œ npx husky install

```

# .cz-config.js

```
module.exports = {
  // type ç±»å‹
  types: [
    { value: 'feat', name: 'âœ¨ æ–°å¢äº§å“åŠŸèƒ½' },
    { value: 'fix', name: 'ğŸ› ä¿®å¤ bug' },
    { value: 'docs', name: 'ğŸ“ æ–‡æ¡£çš„å˜æ›´' },
    {
      value: 'style',
      name: 'ğŸ’„ ä¸æ”¹å˜ä»£ç åŠŸèƒ½çš„å˜åŠ¨(å¦‚åˆ é™¤ç©ºæ ¼ã€æ ¼å¼åŒ–ã€å»æ‰æœ«å°¾åˆ†å·ç­‰)'
    },
    {
      value: 'refactor',
      name: 'â™» é‡æ„ä»£ç ã€‚ä¸åŒ…æ‹¬ bug ä¿®å¤ã€åŠŸèƒ½æ–°å¢'
    },
    {
      value: 'perf',
      name: 'âš¡ æ€§èƒ½ä¼˜åŒ–'
    },
    { value: 'test', name: 'âœ… æ·»åŠ ã€ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹' },
    {
      value: 'build',
      name: 'ğŸ‘·â€ æ„å»ºæµç¨‹ã€å¤–éƒ¨ä¾èµ–å˜æ›´ï¼Œæ¯”å¦‚å‡çº§ npm åŒ…ã€ä¿®æ”¹ webpack é…ç½®'
    },
    { value: 'ci', name: 'ğŸ”§ ä¿®æ”¹äº† CI é…ç½®ã€è„šæœ¬', emoji: 'ğŸ”§' },
    {
      value: 'chore',
      name: 'å¯¹æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å’Œåº“çš„æ›´æ”¹,ä¸å½±å“æºæ–‡ä»¶ã€æµ‹è¯•ç”¨ä¾‹çš„å…¶ä»–æ“ä½œ'
    },
    { value: 'revert', name: 'âª å›æ»š commit' }
  ],

  // scope ç±»å‹ï¼Œé’ˆå¯¹ React é¡¹ç›®
  // scopes: [
  //   ['components'],
  //   ['deps', 'é¡¹ç›®ä¾èµ–ä¿®æ”¹']
  //   // å¦‚æœé€‰æ‹© custom ,åé¢ä¼šè®©ä½ å†è¾“å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ scope , ä¹Ÿå¯ä»¥ä¸è®¾ç½®æ­¤é¡¹ï¼Œ æŠŠåé¢çš„ allowCustomScopes è®¾ç½®ä¸º true
  // ].map(([value, description]) => {
  //   return {
  //     value,
  //     name: `${value.padEnd(30)} (${description})`
  //   }
  // }),

  // allowTicketNumber: false,
  // isTicketNumberRequired: false,
  // ticketNumberPrefix: 'TICKET-',
  // ticketNumberRegExp: '\\d{1,5}',

  // å¯ä»¥è®¾ç½® scope çš„ç±»å‹è·Ÿ type çš„ç±»å‹åŒ¹é…é¡¹ï¼Œä¾‹å¦‚: 'fix'
  /*
    scopeOverrides: {
      fix: [
        { name: 'merge' },
        { name: 'style' },
        { name: 'e2eTest' },
        { name: 'unitTest' }
      ]
    },
   */
  // è¦†å†™æç¤ºçš„ä¿¡æ¯
  messages: {
    type: 'è¯·ç¡®ä¿ä½ çš„æäº¤éµå¾ªäº†åŸå­æäº¤è§„èŒƒï¼\né€‰æ‹©ä½ è¦æäº¤çš„ç±»å‹:',
    scope: '\n é€‰æ‹©ä¸€ä¸ª scope (å¯é€‰):',
    // é€‰æ‹© scope: custom æ—¶ä¼šå‡ºä¸‹é¢çš„æç¤º
    customScope: 'è¯·è¾“å…¥è‡ªå®šä¹‰çš„ scope:',
    subject: 'å¡«å†™ä¸€ä¸ªç®€çŸ­ç²¾ç‚¼çš„æè¿°è¯­å¥:\n',
    body:
      'æ·»åŠ ä¸€ä¸ªæ›´åŠ è¯¦ç»†çš„æè¿°ï¼Œå¯ä»¥é™„ä¸Šæ–°å¢åŠŸèƒ½çš„æè¿°æˆ– bug é“¾æ¥ã€æˆªå›¾é“¾æ¥ (å¯é€‰)ã€‚ä½¿ç”¨ "|" æ¢è¡Œ:\n',
    breaking: 'åˆ—ä¸¾éå…¼å®¹æ€§é‡å¤§çš„å˜æ›´ (å¯é€‰):\n',
    footer: 'åˆ—ä¸¾å‡ºæ‰€æœ‰å˜æ›´çš„ ISSUES CLOSED  (å¯é€‰)ã€‚ ä¾‹å¦‚.: #31, #34:\n',
    confirmCommit: 'ç¡®è®¤æäº¤?'
  },

  // æ˜¯å¦å…è®¸è‡ªå®šä¹‰å¡«å†™ scope ï¼Œè®¾ç½®ä¸º true ï¼Œä¼šè‡ªåŠ¨æ·»åŠ ä¸¤ä¸ª scope ç±»å‹ [{ name: 'empty', value: false },{ name: 'custom', value: 'custom' }]
  allowCustomScopes: false,
  allowBreakingChanges: ['feat', 'fix'],
  // skip any questions you want
  // skipQuestions: [],

  // subject é™åˆ¶é•¿åº¦
  subjectLimit: 100
  // breaklineChar: '|', // æ”¯æŒ body å’Œ footer
  // footerPrefix : 'ISSUES CLOSED:'
  // askForBreakingChangeFirst : true,
}
```

å¦‚æœæ–°å»ºçš„æ–‡ä»¶æç¤º import/no-commonjs æŠ¥é”™ï¼Œç¦ç”¨ CommonJS è¯­æ³•ã€‚å¯ä»¥ç¦ç”¨è¯¥ ESLint è§„åˆ™ã€‚

```
"import/no-commonjs": "off"
```

## äºŒã€ç¯å¢ƒå˜é‡

åœ¨å¼€å‘ä¸­ï¼Œé€šå¸¸æœ‰**å¤šå¥—ç¯å¢ƒ**å»é…ç½®ä¸åŒçš„ç¯å¢ƒå˜é‡

> æ–¹æ¡ˆï¼šå°†å˜é‡å†™åœ¨ `.env.{NODE_ENV}` æ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨ [cross-env](https://www.npmjs.com/package/cross-env) æ³¨å…¥ç¯å¢ƒæ ‡è¯†ï¼Œ[dotenv-flow](https://www.npmjs.com/package/dotenv-flow) å°† `.env.{NODE_ENV}` æ–‡ä»¶åŠ è½½åˆ° `process.env`ï¼Œæœ€åå°† `process.env` å†™å…¥ `taro` é…ç½®æ–‡ä»¶ï¼Œç¯å¢ƒå˜é‡ç»Ÿä¸€ç”¨ `APP_` å¼€å¤´

### 1ã€å°†å˜é‡å†™åœ¨ `.env.{NODE_ENV}` æ–‡ä»¶

æ¨¡ç‰ˆä»“åº“é‡Œé¢ï¼Œä»¥æœ‰`å¼€å‘-dev`ã€`é¢„å‘-pre`ã€`ç”Ÿäº§-prod`ã€`æµ‹è¯•-test`ä¸ºä¾‹ï¼Œåˆ†åˆ«å¯¹åº”æ–‡ä»¶`.env`ã€`.env.pre`ã€`.env.prod`ã€`.env.test` ![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/63d8e2f4187d4c30bbccb08db0152cc3~tplv-k3u1fbpfcp-watermark.image?)

### 2ã€åˆ©ç”¨ [cross-env](https://www.npmjs.com/package/cross-env) æ³¨å…¥ç¯å¢ƒæ ‡è¯†

ç»„åˆ`ç¯å¢ƒ(dev/pre/prod/test) * ç±»å‹(dev/build) * å¹³å°(å°ç¨‹åº/H5)` æ¯”è¾ƒå¤š...ä½†æ˜¯æ¯”æ‰‹åŠ¨åœ¨å‘½ä»¤è¡Œè¾“å…¥å˜é‡å¼º

```json
// package.json
"scripts": {
    "build:weapp": "taro build --type weapp",
    "build:h5": "taro build --type h5",
    "dev:weapp": "npm run build:weapp -- --watch",
    "dev:h5": "npm run build:h5 -- --watch",
    "build-pre:weapp": "cross-env APP_ENV=pre taro build --type weapp",
    "build-pre:h5": "cross-env APP_ENV=pre taro build --type h5",
    "dev-pre:weapp": "cross-env APP_ENV=pre npm run build:weapp -- --watch",
    "dev-pre:h5": "cross-env APP_ENV=pre npm run build:h5 -- --watch",
    "build-test:weapp": "cross-env APP_ENV=test taro build --type weapp",
    "build-test:h5": "cross-env APP_ENV=test taro build --type h5",
    "dev-test:weapp": "cross-env APP_ENV=test npm run build:weapp -- --watch",
    "dev-test:h5": "cross-env APP_ENV=test npm run build:h5 -- --watch",
    "build-prod:weapp": "cross-env APP_ENV=prod taro build --type weapp",
    "build-prod:h5": "cross-env APP_ENV=prod taro build --type h5",
    "dev-prod:weapp": "cross-env APP_ENV=prod npm run build:weapp -- --watch",
    "dev-prod:h5": "cross-env APP_ENV=prod npm run build:h5 -- --watch"
}
```

### 3ã€åˆ©ç”¨[dotenv-flow](https://www.npmjs.com/package/dotenv-flow) å°† `.env.{NODE_ENV}` æ–‡ä»¶åŠ è½½åˆ° `process.env`å¹¶å†™å…¥ taro é…ç½®æ–‡ä»¶

é»˜è®¤æ³¨å…¥`dev`æ ‡è¯†ï¼Œèµ· h5 dev æœåŠ¡æ‰§è¡Œ`yarn dev:h5`å³å¯

```js
// config/dev.js ï½œ config/prod.js
process.env.APP_ENV = process.env.APP_ENV || 'dev'

require('dotenv-flow').config({
  // node_devè¡¨ç¤º.env.{node_env}æ–‡ä»¶
  node_env: process.env.APP_ENV
})

module.exports = {
  env: {
    NODE_ENV: '"development"',
    APP_VERSION: `"${process.env.npm_package_version}"`,
    APP_ENV: `"${process.env.APP_ENV}"`,
    APP_API: `"${process.env.APP_API}"`
  }
}
```

```
pnpm add cross-env dotenv-flow -D
```

## ä¸‰ã€å›¾ç‰‡å¤„ç†

> æ–¹æ¡ˆï¼Œå°å›¾æ ‡ç”¨ `iconfont`ï¼Œå€ŸåŠ© [taro-iconfont-cli](https://www.npmjs.com/package/taro-iconfont-cli) è¿™ä¸ªåŒ…å°†å›¾ç‰‡å¤„ç†æˆ `svg`ï¼›å¤§å›¾æ ‡ç”¨`CDN`

### 1ã€å°å›¾æ ‡

ï¼ˆ1ï¼‰å®‰è£… taro-iconfont-cli

```bash
npm i taro-iconfont-cli -D
```

ï¼ˆ2ï¼‰åˆå§‹åŒ–é…ç½®æ–‡ä»¶

```bash
npx iconfont-init
```

å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•ç”Ÿæˆäº†é…ç½®æ–‡ä»¶`iconfont.json`ï¼Œå…·ä½“å‚æ•°è¯´æ˜å¯æŸ¥çœ‹[taro-iconfont-cli](https://www.npmjs.com/package/taro-iconfont-cli)å®˜ç½‘

```json
{
  // ç›´æ¥å¤åˆ¶[iconfont](http://iconfont.cn/)å®˜ç½‘æä¾›çš„é¡¹ç›®é“¾æ¥
  "symbol_url": "http://at.alicdn.com/t/font_1373348_kk9y3jk2omq.js",
  // æ ¹æ®iconfontå›¾æ ‡ç”Ÿæˆçš„ç»„ä»¶å­˜æ”¾çš„ä½ç½®ã€‚æ¯æ¬¡ç”Ÿæˆç»„ä»¶ä¹‹å‰ï¼Œè¯¥æ–‡ä»¶å¤¹éƒ½ä¼šè¢«æ¸…ç©ºã€‚
  "save_dir": "./src/assets/iconfont",
  // å¦‚æœæ‚¨çš„é¡¹ç›®ä½¿ç”¨Typescriptç¼–å†™ï¼Œè¯·è®¾ç½®ä¸ºtrueã€‚è¿™ä¸ªé€‰é¡¹å°†å†³å®šç”Ÿæˆçš„å›¾æ ‡ç»„ä»¶æ˜¯`.tsx`è¿˜æ˜¯`.js`åç¼€ã€‚
  "use_typescript": true,
  // é€‰æ‹©éœ€è¦æ”¯æŒçš„å¹³å°ï¼Œé»˜è®¤æ˜¯`*`ï¼Œæ„å‘³ç€æ‰€æœ‰å¹³å°éƒ½éœ€è¦æ”¯æŒï¼ˆå¦‚æœæœ‰ï¼‰ã€‚å¦‚æœä½ åªæƒ³æ”¯æŒéƒ¨åˆ†å¹³å°ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æˆæ•°ç»„ï¼š
  "platforms": ["weapp", "h5"],
  // æ˜¯å¦ä½¿ç”¨[å°ºå¯¸å•ä½rpx]è¿˜æ˜¯æ™®é€šçš„åƒç´ å•ä½`px`ã€‚é»˜è®¤å€¼ä¸ºtrueï¼Œä¸Taroä¿æŒä¸€è‡´çš„ç¼©æ”¾ã€‚æ‚¨ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºfalseï¼Œå¼ºåˆ¶ä½¿ç”¨`px`
  "use_rpx": true,
  "trim_icon_prefix": "icon",
  "default_icon_size": 18,
  "design_width": 750
}
```

ï¼ˆ3ï¼‰ç”Ÿæˆ Taro æ ‡å‡†ç»„ä»¶æ‰§è¡Œ`yarn icon`

```json
// package.json
"scripts": {
    "icon": "npx iconfont-taro"
}
```

ï¼ˆ4ï¼‰ä½¿ç”¨å›¾æ ‡

```js
//xx.tsx
import { resolve } from 'path'
;<IconFont name='user' size={40} color='#333' />
```

> å›¾æ ‡å¤šäº†ï¼Œä¼šå‡ºç°å›¾ç‰‡ä½“ç§¯å¢å¤§çš„é—®é¢˜ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä½“ç§¯éå¸¸ç´§å¼ ï¼ˆå°ç¨‹åºä½“ç§¯æœ‰è¦æ±‚ï¼‰ï¼Œæ²¡æœ‰å¤šä½™çš„ä½“ç§¯ç»™å›¾æ ‡ï¼Œå¯ä»¥è€ƒè™‘ `å­—ä½“å›¾æ ‡`ï¼Œç›´æ¥ä½¿ç”¨å­—ä½“å›¾æ ‡çš„è¯å¯èƒ½ä¼šå¯¹é¦–å±æ—¶é—´æœ‰ä¸€ç‚¹å½±å“ï¼Œå¦‚æœå…³æ³¨è¿™ä¸ªçš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `CDN`

### 2ã€å¤§å›¾æ ‡

å°±æ¯”è¾ƒç®€å•äº†ï¼Œå°† CDN å‰ç¼€æŠ½ç¦»ä¸ºå¸¸é‡ `CDN_IMG` å†™åœ¨ `constants` æ–‡ä»¶å¤¹ä¸‹ï¼Œä½¿ç”¨æ—¶ï¼Œæ‹¼æ¥å›¾ç‰‡åœ°å€

```js
// src/constants/index.ts
export const CDN_IMG = 'https://www.baidu.com/img/'
```

```js
// xx.tsx
import { Image } from '@tarojs/components'
import { CDN_IMG } from '@/constants'
;<Image src={`${CDN_IMG}PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png`} />
```

## äº”ã€æ ·å¼(é€‚é…)å¤„ç†

#### 1ã€ç¡®å®šè®¾è®¡ç¨¿å°ºå¯¸

- Taro é»˜è®¤ä»¥ `750px` ä½œä¸ºæ¢ç®—å°ºå¯¸æ ‡å‡†ï¼›å¦‚æœè®¾è®¡æçš„å°ºå¯¸ä¸æ˜¯ 750ï¼Œå¯é€šè¿‡ `designWidth`é…ç½®
- é»˜è®¤æ”¯æŒ `750`ã€ `640` ã€ `828` ä¸‰ç§å°ºå¯¸è®¾è®¡ç¨¿ï¼›å¦‚æœéœ€è¦æ”¯æŒè‡ªå®šä¹‰è®¾è®¡ç¨¿ï¼Œå¯é€šè¿‡ `deviceRatio `è‡ªå®šä¹‰ï¼›æ¯”å¦‚`'375':2/1`

```js
// config/index.js
const config = {
  ...
  // è®¾è®¡ç¨¿å°ºå¯¸
  designWidth: 750,
  // è®¾è®¡ç¨¿å°ºå¯¸æ¢ç®—è§„åˆ™
  deviceRatio: {
    640: 2.34 / 2,
    750: 1,
    828: 1.81 / 2,
    350: 2 / 1
  },
  ...
}
```

#### 2ã€å¤–è”æ ·å¼å†™æ³•

- æ ¹æ®è®¾è®¡æ `1:1` ç›´æ¥å†™`px`ã€æˆ–è€…`%`å³å¯ï¼ŒTaro é»˜è®¤ä¼šå¯¹æ‰€æœ‰çš„å•ä½è¿›è¡Œè½¬æ¢ï¼›å½“è½¬æˆ`å¾®ä¿¡å°ç¨‹åº`çš„æ—¶å€™ï¼Œå°ºå¯¸å°†é»˜è®¤è½¬æ¢ä¸º `rpx`ï¼Œå½“è½¬æˆ `H5` æ—¶å°†é»˜è®¤è½¬æ¢ä¸ºä»¥ `rem` ä¸ºå•ä½çš„å€¼
- ä¸å¸Œæœ›è¢«è½¬æ¢çš„å•ä½ï¼Œåœ¨ px å•ä½ä¸­å¢åŠ ä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œä¾‹å¦‚ `Px` æˆ–è€… `PX` ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–æ–¹æ¡ˆï¼Œä¸è¿‡ä¸å¸¸ç”¨ï¼Œå…·ä½“å¯è§[å®˜ç½‘](https://taro-docs.jd.com/taro/docs/size)

<!---->

- é…ç½® `1px` ä¸è½¬æ¢ï¼Œé€šè¿‡é…ç½® `onePxTransform` å­—æ®µä¸º `false`ï¼Œå¦‚ä¸‹

```js
// config/index.js
const config = {
  ...
  h5: {
    publicPath: '/',
    staticDirectory: 'static',
    postcss: {
      autoprefixer: {
        enable: true
      },
      pxtransform: {
        enable: true,
        config: {
          onePxTransform: false // H5é…ç½® 1px ä¸éœ€è¦è¢«è½¬æ¢
        }
      }
    }
  },
  ...
}
```

#### 3ã€å†…è”æ ·å¼å†™æ³•

åœ¨ç¼–è¯‘æ—¶ï¼ŒTaro ä¼šå¸®ä½ å¯¹æ ·å¼åšå°ºå¯¸è½¬æ¢æ“ä½œï¼Œä½†æ˜¯å¦‚æœæ˜¯åœ¨ JS ä¸­ä¹¦å†™äº†è¡Œå†…æ ·å¼ï¼Œé‚£ä¹ˆç¼–è¯‘æ—¶å°±æ— æ³•åšæ›¿æ¢äº†ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒTaro æä¾›äº† `Taro.pxTransform` æ¥åšè¿è¡Œæ—¶çš„å°ºå¯¸è½¬æ¢

å»ºè®®ç»Ÿä¸€æŠ½ç¦»åˆ° `utils` é‡Œé¢

#### 4ã€1px é—®é¢˜

äº§ç”ŸåŸå› 

### å°ç¨‹åºåˆ†åŒ…

1ã€è§£é‡Šä»€ä¹ˆæ˜¯åˆ†åŒ…å®˜æ–¹æ–‡æ¡£è¯´æ˜å¦‚ä¸‹ï¼Œç®€è€Œè¨€ä¹‹å°±è¯´åˆ†åŒ…æ˜¯ä¸€ä¸ªä¼˜åŒ–é¡¹ï¼Œå¯ä»¥ä¼˜åŒ–å°ç¨‹åºé¦–æ¬¡å¯åŠ¨çš„ä¸‹è½½æ—¶é—´

2ã€æ€ä¹ˆåšåˆ†åŒ…

é…ç½®æ–‡ä»¶å¦‚ä¸‹

```
export default {
  // ä¸»åŒ…
  pages: [
    "pages/tab/home/index",        // é¦–é¡µ
    "pages/tab/mine/index"         // æˆ‘çš„
  ],
  // å­åŒ…
  subpakages: [                    // å­åŒ…ï¼šuserï¼Œä¸ªäººä¸­å¿ƒ
    {
      root: 'pages/user/',
      pages: [
        "address/index",           // ä¸ªäººåœ°å€ä¿¡æ¯é¡µ
        "settings/index"           // ä¸ªäººä¿¡æ¯è®¾ç½®é¡µ
      ]
    },
    {
      root: 'pages/order/',        // å­åŒ…ï¼šorderï¼Œè®¢å•ä¸­å¿ƒ
      pages: [
        "list/index",              // è®¢å•åˆ—è¡¨
        "detail/index"             // è®¢å•è¯¦æƒ…
      ]
    }
  ],
  window: {
    backgroundTextStyle: "light",
    navigationBarBackgroundColor: "#fff",
    navigationBarTitleText: "WeChat",
    navigationBarTextStyle: "black",
  },
};
```


#### é›†æˆreduxjs/toolkit
 ```
 // reduxåŠå·¥å…·åŒ…
pnpm add @reduxjs/toolkit react-redux
pnpm add @types/react-redux -D

pnpm add @types/redux-logger redux-logger //æ—¥å¿—åŒ…
pnpm add redux-persist //æ•°æ®ç¼“å­˜
 ```